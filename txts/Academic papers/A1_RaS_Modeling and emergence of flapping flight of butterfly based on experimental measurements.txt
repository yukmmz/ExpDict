Robotics and Autonomous Systems 60 (2012) 670–678
Contents lists available at SciVerse ScienceDirect
Robotics and Autonomous Systems
journal homepage: www.elsevier.com/locate/robot
Modeling and emergence of flapping flight of butterfly based on
experimental measurements
Kei Senda a,∗, Takuya Obara b, Masahiko Kitamura b, Tomomi Nishikata b, Norio Hirai c, Makoto Iima d,
Naoto Yokoyama a
a Kyoto University, Yoshida-Honmachi, Sakyo-ku, Kyoto, 606-8501, Japan
b Kanazawa University, Kanazawa, Ishikawa 920-1192, Japan
c Osaka Prefecture University, Japan
d Hiroshima University, Japan
a r t i c l e    i n f o
Article history:
Available online 28 December 2011
Keywords:
Modeling
Flapping flight
Butterfly
Experimental measurements
a b s t r a c t
The objective of this paper is to clarify the principle of stabilization in flapping-of-wing flight of a butterfly,
which is a rhythmic and cyclic motion. For this purpose, a dynamics model of a butterfly is derived by
Lagrange’s method, where the butterfly is considered as a rigid multi-body system. For the aerodynamic
forces, a panel method is applied. Validity of the mathematical models is shown by an agreement of the
numerical result with the measured data. Then, periodic orbits of flapping-of-wing flights are searched
in order to fly the butterfly models. Almost periodic orbits are obtained, but the model in the searched
flapping-of-wing  flight  is  unstable.  This  research,  then,  studies  how  the  wake-induced  flow  and  the
flexibly torsional wing’s effect on the flight stability. Numerical simulations demonstrate that both the
wake-induced flow and the flexible torsion reduces the flight instability. Because the obtained periodic
flapping-of-wing flight is unstable, a feedback control system is designed, and a stable flight is realized.
© 2011 Elsevier B.V. All rights reserved.
1.  Introduction
Butterflies can maintain desired flapping-of-wing flights against
environmental uncertainties and variations, e.g. gust, weight gain
or  loss,  etc.,  using  their  adaptation-capability.  Such  an  adaptive
function is considered to emerge from the interaction of the ner-
vous system, body, and environment. We call the adaptive motor
function ‘‘Mobiligence’’.
The  flapping  flight  of  butterfly  is  an  example  of  Mobiligence
in which the environment is the generated flow field. Actually, it
essentially has the same structure with other Mobiligence subjects,
e.g.,  to  emerge  the  flapping  flight  from  the  interaction  of  the
nervous system, body, and environment. From the viewpoint, this
study discusses the principle to emerge the stable flapping flight of
butterfly, which is a rhythmical periodic motion.
There are many unknown points for the stable flight, e.g. ‘‘how
the butterfly moves’’, ‘‘how the control is realized’’, etc. Concretely,
this study investigates the following two issues by the biological
analysis  through  experimental  observations  of  living  butterflies
∗  Corresponding author. Tel.: +81 774 383960; fax: +81 774 38 3962.
E-mail addresses: senda@kuaero.kyoto-u.ac.jp (K. Senda),
n_hirai@envi.osakafu-u.ac.jp (N. Hirai), makoto@mis.hiroshima-u.ac.jp (M. Iima),
yokoyama@kuaero.kyoto-u.ac.jp (N. Yokoyama).
and  by  the  systems  engineering  or  the  synthetic  approach.  This
paper summarizes a part of study results obtained by a research
project based on this approach. Refs. [1–8] reports some studies in
detail.
An experimental system with a low-speed wind tunnel is con-
structed to measure the motion and aerodynamic forces of actual
butterflies quantitatively. A 3D mathematical model is constructed
by using a panel method for aerodynamics formulation in order to
analyze the stability of free-flying butterflies and so on. Its validity
and  accuracy  are  examined  by  comparing  with  the  obtained  ex-
perimental data. A periodic trajectory of flapping-of-wing flight is
searched in order to fly the constructed butterfly model. Using the
constructed numerical simulator and the obtained periodic trajec-
tory, it is shown that the free-vortices in the wakes provides a type
of  stabilization  effect.  In  addition,  wing  torsion  caused  by  struc-
tural flexibility is also introduced to the model and its effect on the
flapping-of-wing flight is examined. But the obtained trajectory is
still unstable, and the butterfly model goes down after a few flap-
ping periods. Therefore, a feedback control system is discussed to
realize a stable flight. A designed controller stabilizes the flapping-
of-wing flight, where the fully nonlinear model is controlled by a
sampled-data linear controller.
The rest of this paper is organized as follows. Section 2 organizes
flapping  mechanism  of  butterfly  using  anatomical  observation
and   knowledge   of   musculoskeletal   system.   Section   3   shows
0921-8890/$ – see front matter © 2011 Elsevier B.V. All rights reserved.
doi:10.1016/j.robot.2011.12.007
K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678                                                                                                      671
observation experiments and measured results. Section 4 explains
modeling  of  butterfly,  in  which  a  butterfly  is  considered  as  a
rigid multi-body system, and aerodynamic forces are formulated
by  a  panel  method.  Its  numerical  results  are  compared  with  the
measured  data,  and  their  good  agreement  justifies  the  validity
and accuracy of the mathematical model. In Section 5, a periodic
trajectory  of  flapping-of-wing  flight  is  searched  by  using  the
constructed numerical simulator, and an almost periodic trajectory
is  obtained.  Wing  torsion  caused  by  structural  flexibility  is  also
introduced  to  the  model  and  its  effect  on  the  flapping-of-wing
flight is examined. Numerical simulations show the extension of
the flying period considering them. Meanings of this stabilization
effect is discussed, which can be considered as a common principle
of  mobiligence.  Because  the  obtained  periodic  flapping-of-wing
flight   is   unstable,   a   feedback   control   system   is   designed   in
Section 6, and a stable flight is realized. Finally, concluding remarks
are given in Section 7.
2.  Flapping mechanism of butterfly
2.1.  Outline of flapping mechanism
Fig. 1 schematically illustrates a flapping mechanism of insects
that is powered by indirect muscles [9]. The wings are connected
to  the  thorax  by  lever  mechanisms,  where  the  wings  have  been
evolved from exoskeleton. The end of the wing link is connected
by a hinge with the lateral suctum in the thorax. The wing link is
also connected by another hinge near the previous hinge with the
thoral wall in the thorax. When the suctum lifts up, the principle
of leverage moves the wing down. The horizontal muscles known
as dorsal longitudinal muscles tends to contract and increase the
curvature  of  the  suctum  to  which  the  muscles  are  connected  to
the  rear  and  the  front.  There  are  vertical  muscles  known  as  the
dorsoventral  muscles  running  from  the  roof  of  the  thorax  to  the
floor.  Contraction  of  the  dorsoventral  muscles  pulls  the  suctum
down.  While  relaxation  of  the  dorsoventral  muscles  results  in
the  dorsal  longitudinal  muscles’  contraction  and  the  suctum’s
lifting  up.  This  flapping  mechanism  can  be  considered  as  almost
one degree-of-freedom vibrating mechanism. A butterfly contracts
the  dorsoventral  muscles  periodically  to  vibrate  the  mechanism
for flapping of the wings. According to experimental observation
in  latter  section,  each  butterfly  has  an  almost  constant  flapping
eigenfrequency.  It  may  be  because  to  vibrate  sympathetically
at  eigenfrequency  of  the  mechanism  realizes  efficient  flapping
motion  [10].  As  suggested  in  the  anatomical  observation  below,
the other direct muscles may add slight motions, which are in the
extent of modification to the basic vibration.
2.2.  Anatomical observation of butterfly
To  clarify  the  possible  flight  movements,  morphology  of  tho-
racic  muscles  of  a  danaid  butterfly,  Parantica  sita  niphonica  is
investigated    using    the    micro-XCT    scanner,    Comscantecno
ScanXmate-A080S. The X-ray tube voltage, the tube current, and
the  minimum  resolution  (i.e.  slice  width  and  pitch)  are  adjusted
70 kV, 90 mA, and 18 µm, respectively. Three-dimensional images
are obtained by the software, Analyze. Fig. 2 shows examples of 3D
images reconstructed with XCT images as wings are in horizontal
position. The following investigation uses XCT images of the space-
men whose wings are in horizontal, top, and bottom positions.
As a result, the above-mentioned major indirect flight muscles
including dorsal longitudinal muscles and dorso-ventral muscles
of  this  species  are  identified.  Some  direct  flight  muscles  such
as  basalar  muscles  and  subalar  muscles  are  attached  below  the
forewings via basalare and subalare, respectively.
Fig. 1.   Indirect muscle system driving wing mechanism (left: thorax cross section,
right: thorax longitudinal section).
Fig. 2.   3D images reconstructed with micro-XCT images of Parantica sita niphonica.
As known in other butterflies, Parantica sita niphonica basically
uses  indirect  muscles  for  upstroke  and  downstroke  and  uses
direct muscles for forward and rearward inclination of forewings.
Therefore,  it  is  reasonable  to  assume  that  living  Parantica  sita
niphonica  can  generate  the  motions  applied  to  a  mathematical
model in the latter section.
3.  Models of butterfly
3.1.  Dynamics model as rigid multi-body system
A  butterfly  is  modeled  by  a  rigid  multi-body  system  as  well
as  typical  robot  modeling,  which  is  simple  dynamics  modeling.
672                                                                                              K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678
Fig. 3.   Frames and coordinates for modeling of a butterfly.
For more precise modeling, it will be desirable to consider a flexible
multi-body system because experimental observations have found
that  butterfly  wings  are  elastically  deformed  by  aerodynamic
forces.
The  butterfly  model  is  a  multi-body  system  with  4  links  as
shown  in  Fig.  3,  which  is  composed  of  the  thorax  Bt  considered
as  the  main  body,  the  abdomen  Ba,  the  left  wings  WL,  and  the
right wings WR. Both the model and its motions are supposed to be
symmetrical. A pair of fore and hind wings on each side is modeled
by a plate as shown in Fig. 3. The joint between the thorax and wing
has  3  rotational  degree-of-freedom  (DOF)  and  the  joint  between
the thorax and the abdomen has 1 DOF.
The following Lagrangian equations of motion are obtained:
Mθ¨ + M˙θ˙ −  1
2
∂
∂θ 
θ˙Mθ˙ +  ∂V
∂θ  = τ                                 (1)
where  the  generalized  coordinates  are  θ  =   [x  z  θt   θa   β  η θ]T .
As  illustrated  in  Fig.  3,  x, z,  and  θt    are  the  x,  y-positions  and
the  attitude  angle  of  the  thorax,  θa    the  abdomen  angle,  β  the
flapping angle in up-down direction, η the lead–lag angle, and θ the
feathering angle representing a torsion angle. The M and V  are the
inertia  matrix  and  the  gravitation  potential  energy,  respectively.
The vector τ = τd +τcontrol  is the generalized forces corresponding
to θ, where τd  and τcontrol  are the aerodynamic torque and the joint
control torque, respectively, developed in the following sections.
3.2.  Aerodynamic models
In the flight of the butterfly, there is a feature in which the flap-
ping  frequency  is  small  [10]  as  well  as  small  Reynolds  number.
Moreover, the flow to the wings is not steady because of the flap-
ping motion, whereas the flow to a cruising fixed-wing aircraft is
steady. Wing-tip vortices greatly affect the aerodynamic character-
istics because a butterfly has flat wings of a small aspect ratio. In
addition, the flapping motion generates very strong wing-tip vor-
tices. The wing-tip vortices may combine to the free-vortices leav-
ing from the trailing edge, make complex structures, and greatly
influence the aerodynamic characteristics.
Therefore,  this  study  models  the  aerodynamics  of  a  flapping-
of-wing butterfly using a panel method [11]. Vortex ring element
panels are set on wing surfaces and panels with constant strengths
of vortices are shed into wakes. Unknown strengths of vortices are
determined so as to satisfy the boundary condition of no normal
flow  across  the  wing  surfaces.  The  free  wake  model  sheds  the
panels fulfilling the Kutta condition at trailing edge and the panels
move with local stream velocity. This free wake model enables to
contain the influence of the unsteady wakes. As a result, this study
made a panel method model [3–5].
A  lumped-vortex  method  model  is  introduced  in  this  paper
to  discuss  the  effect  of  unsteady  wakes  by  comparing  with  the
panel method. The lumped-vortex method model considers only
the  vortex  ring  panels  on  wing  surfaces,  removing  the  panels
in  wakes  from  the  panel  method  model.  However,  the  model
referred as the lumped-vortex method in this paper additionally
considers  the  characteristic  flapping-of-wing  effects  [3],  where
each  effect  is  modeled  separately.  This  study  has also  developed
other aerodynamic models [3–5], whereas they are not mentioned
in this paper.
4.  Experiments and simulations
4.1.  Outline of experimental system
Verification of the models and parameter setting require funda-
mental data of flapping-of-wing motions and aerodynamic forces.
For this purpose, an experimental system with a low-speed wind
tunnel is constructed and a wind tunnel experiment is conducted
using actual butterflies [4], scientific name Parantica sita niphon-
ica, which is similar to Danaus in the US. It is 0.24 g weight and its
half wing span is 50 mm long. Specifications of the butterfly are
listed in Ref. [2].
The   simultaneous   measurement   system   is   constructed   as
illustrated  in  Fig.  4,  which  measures  butterfly’s  motion  and  the
forces  applied  to  the  butterfly  using  an  optical  measurement
system and a force measurement system. The butterfly is gummed
up  on  the  back  of  the  thorax  to  the  tip  of  the  measure,  i.e.  the
force/torque sensor. The measure with the butterfly is put into the
wind tunnel, the flapping-of-wing motion in the flow is captured
as a video image, and the state vector θ is measured using the video
images. Simultaneously, the forces applied to the butterfly, i.e. lift
L, drag D and pitching moment M, are sensed by the measure. There
is a smoke wire for airflow visualization.
According to calibration experiments, the maximum measuring
error in L and D is 0.001 (N) for a range of ±0.02 (N), and that in M
is 0.04×10−3  (N m) for ±0.6×10−3  (N m). The cutoff frequency of
the measure is 50 (Hz) for noise reduction. The maximum error in
position measurements using the video images is 0.13 × 10−3  (m)
in  each  direction,  which  is  caused  by  the  resolution  of  images:
0.260×10−3  (m/pixel). Based on this error, the maximum error in
the abdomen angle is 0.37° for motion measurement. The smoke
is made of the propylene glycol by smoke-wire method. According
to  an  evaluation  method  in  [12],  the  tracers  in  smoke  follow-up
accurately the air-flow.
4.2.  Experimental observation of motion and force
An experiment for Parantica sita niphonica is conducted under
a condition that the mainstream is 1.64 m/s, the thoracic positions
x    =   z    =   0  m,  and  its  angle  θt      =   −1°.  Fig.  5(a)  shows  the
generalized coordinates θ of an experimental result measured by
the above optical measurement system.
Fig.  5(b)–(d)  illustrate  the  measured  forces  at  the  tip  of  the
measure,  i.e.  the  lift  L,  the  drag  D,  and  the  force  moment  M.
The  butterfly  repeats  this  cyclic  motion  in  a  period  of  0.136  s
when it continues the periodic flapping-of-wing motion. Measured
aerodynamic forces are also cyclic during the periodic flapping-of-
wing motion.
The  flapping  angle  β is  a  cosine-like  curve  whose  maximum
and minimum are 81° and −45°. The left and right wings overlaps
perfectly at the maximum position. The abdomen angle θa  is also
a  sinusoidal  curve,  but  is  out  of  phase  to  the  flapping  angle  β.
When the butterfly varies amplitude, it changes the minimum of
β mainly and the maximum marginally. The fixed butterfly swings
the  abdomen  unnaturally  in  a  larger  amplitude  than  butterflies
flying  freely.  Even  if  β  or  θa   changes  the  amplitude  depending
on  the  flying  condition  and/or  the  individual,  they  keep  similar
smooth  cosine  curves.  Lead–lag  angle  η  has  a  vibration  mode
K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678                                                                                                      673
Fig. 4.   Experimental setup.
whose frequency is twice as large as β. Feathering angle θ seems
to  be  varied  passively  in  small  by  the  aerodynamic  forces.  Fry
et al. [13] similarly observes fly’s flapping-of-wing motion.
As  can  be  seen  in  Fig.  5(a),  the  feathering  angle  θ  varies
approximately between a range of ±30° through a flapping period.
This  fluctuation  of  the  θ  is  considered  as  a  result  of  a  passive
wing  torsion  caused  by  its  structural  flexibility  since  butterflies
cannot  actively  twist  their  wings  in  a  large  angle  because  of  the
flapping mechanism. In a latter section, the passive wing torsion
is introduced to the model, and its effect on the flapping-of-wing
flight stability is evaluated.
4.3.  Verification of mathematical models
The  θ  obtained  from  the  experiment  and  its  derivatives  θ˙
and   θ¨   are   substituted   into   the   mathematical   models   of   the
butterfly  that  is  fixed  on  the  back  of  the  thorax  to  the  tip  of  the
measure.  Its  aerodynamic  forces  are  illustrated  in  Fig.  5(b)–(d).
The aerodynamic models are the lumped-vortex method with the
characteristic flapping effects and the panel method. Validity of the
model can be evaluated by comparing the simulation results with
the experimental data.
For  the  lumped-vortex  method,  two  results  are  represented.
One   is   the   result   using   the   parameters   suitable   for   the   past
experimental result of Parantica sita niphonica under a condition
that the mainstream is 1.0 m/s and the thoracic angle θt   = 31°. The
other is the result after adjusting the parameter to be suitable for
the present experiment. The lumped-vortex method model with
the characteristic flapping effects has many adjustable parameters.
Hence  the  model  with  parameters  for  the  present  experiment
obtains better agreement with the measured result in comparison
with  the  one  for  the  other  experiment.  On  the  other  hand,  the
model  for  the  other  experiment  shows  some  error  at  the  top  or
the bottom of flapping angle. This means that the lumped-vortex
method model must use the parameters suitable for instantaneous
condition, e.g. the angle of attack, the flow velocity to the wings,
etc. The lumped-vortex method model is not necessarily suitable
for  a  free-flying  butterfly  because  the  flow  is  unsteady  and  the
condition always varies.
On the other hand, the panel method can calculate the aerody-
namic forces with the same degree of accuracy for any experiment.
Fig. 6 shows the experimental result of Parantica sita niphonica un-
der a condition that the mainstream is 1.54 m/s and the thoracic
angle θt    =  28.1°, and the numerical result by the panel method.
The panel method model always agrees well with experimental re-
sults by considering unsteady flow induced by wakes.
Left  figures  in  Fig.  7  show  that  the  flow  around  the  wings
visualized by a smoke wire. They are side view images of every 4
frames shot in 250 FPS, i.e. the interval of the images is 0.016 s.
Referring  the  inertial  frame  ΣI   in  Fig.  3,  the  origin  of  thorax
frame  ΣBt   is  at  the  origin  of  ΣI ,  the  mainstream  flows  in  −iI
direction and the sagittal plane of the butterfly is on iI   − kI  plane.
In this case, the smoke wire is placed upstream of the butterfly, in
−0.044jI   (m), and parallel to kI , where the length of each wing is
almost 0.05 (m). A trail of smoke from a point makes a streak line,
and the smoke from the whole smoke wire forms a sheet. In case
without butterfly, the sheet-like smoke forms a plane that parallels
to iI  − kI  plane.
The  brightness  of  smoke  has  a  positive  correlation  with  the
density of tracers because the whole area is lighted uniformly and
the  images  are  taken  from  −jI    direction.  The  brightness  of  the
plane  of  sheet-like  smoke  without  butterfly  is  almost  constant
everywhere  in  an  image.  In  case  with  a  butterfly,  the  sheet-like
smoke  bends  out-of-plane  direction  because  butterfly  flapping
(a) Motion.                                                                             (b) Lift.
(c) Drag.                                                                                          (d) Pitching moment.
Fig. 5.   Aerodynamic forces of lumped-vortex method and panel method.
674                                                                                              K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678
(a) Motion.                                                                               (b) Lift.
(c) Drag.                                                                                     (d) Pitching moment.
Fig. 6.   Verification of panel method by aerodynamic forces.
induces  three  dimensional  flow  with  jI    velocity.  The  flapping-
induced vortex structure can be estimated qualitatively from the
brightness  of  the  smoke  in  an  image  because  the  tracer  density
becomes lower at larger induced velocity. From the experimental
result, it is understood that the complex flow field is formed by the
flapping-induced free vortex in wakes.
In numerical simulations of the panel method, the velocity at
any  point  can  be  obtained  by  Biot–Savart  law,  which  calculates
the  velocity  induced  by  each  vortex  element.  In  right  figures,
small  arrows  at  lattice  points  denote  the  local  velocities  relative
to mainstream calculated by the panel method. In depth direction,
the  arrows  are  illustrated  simultaneously  from  −0.12  to  0  (m).
In  the  figures,  more  long  arrows  appear  at  a  region  with  larger
induced   velocity.   These   figures   are   suitable   to   compare   with
the experimental images qualitatively. This numerical simulation
captures the unsteady flow field of the experiment. For reference,
the  lumped-vortex  method  model  does  not  have  any  abilities  to
describe the complex unsteady flow.
Viscosity effect should be considered in the model because of
the  low  Reynolds  number  Re   ≃   103   for  the  butterfly.  However,
both computational and experimental evaluations show that the
viscous  drag  is  negligible  amount  with  approximately  0.5%  of
the  maximum  drag.  Compressibility  is  not  taken  into  account
because  of  low  speed.  It  is  observed  in  Fig.  8  by  the  smoke  wire
visualization  that  the  flow  passes  along  wing  surfaces  without
separation during wingbeat. The panel method model might result
in good agreement with the real flow, where the model is based on
potential  flow  theorem  assuming  nonviscous  and  incompressive
flow without separation.
Motion  of  a  free-flying  butterfly  is  measured  by  using  the
experimental system of Fig. 4. Fig. 9(a) and (b), respectively, show
a  period  of  measured  entire  butterfly  motion  in  periodic  free-
flight  and  the  numerical  result  when  entire  motion  is  calculated
by  the  obtained  model  using  the  measured  joint  trajectory.  The
numerical result duplicates the free-flight, even though the final
thorax  angles  have  some  difference.  The  obtained  model  is  the
most accurate among models constructed by the present authors,
i.e. simple method [1], the lumped-vortex method considering the
characteristic flapping-of-wing effects [2], and the panel method
model without free-vortices in wakes, because the other existing
models cannot duplicate the free-flight.
5.  Periodic flapping flight
Even when the measured joint trajectory of an actual butterfly
is   used,   the   entire   free-flying   motion   of   numerical   model   is
different  from  the  actual  butterfly.  This  result  shows  that  the
model cannot reproduce the actual butterfly perfectly, whereas the
model duplicates the free-flight. Hence, a flapping joint trajectory
is searched below for a periodic free-flight of the numerical model.
Using the obtained model and trajectory, effects of free-vortices in
wakes and structural flexibility of wings are discussed.
5.1.  Trajectory search
The periodic flapping-of-wing flight is defined as ‘‘all other than
x in state vector θf   and θ˙f   after a flapping-of-wing period T  agree
with initial value θs  and θ˙s’’.
Joint angle trajectories are described by Fourier series for cyclic
motions. Fourier parameters and initial conditions are considered
as  learning  parameters  of  vector  w  to  find  a  trajectory  of  the
periodic  flapping-of-wing  flight.  In  order  to  reduce  computation
efforts,  the  number  of  parameters  is  cut  down  based  on  the
knowledge from the experiments and observation.
The following cost function J is used for the learning evaluation:
J  =  
i
Qi  θfi  − θsi2
+ R E(θf , θ˙f ) − E(θs, θ˙s) + 
j      
T
0
τjdθj                       (2)
where  E(θ, θ˙)  =   T (θ, θ˙) +  V (θ) is  the  mechanical  energy  with
the  kinetic  energy  T (θ, θ˙) and  the  potential  energy  V (θ).  The  θj
K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678                                                                                                      675
Fig.  7.    Comparison  of  flow  fields  of  experimental  visualization  and  numerical
simulation by panel method every 0.036 s (V  = 1.0 m/s, θt   = −10°).
Fig. 8.   Visualized flow around wing during downstroke (V  = 1 m/s).
and  τj   are  the  angle  and  the  torque  of  joint  j.  The  Qi   and  R  are
evaluation  weights.  The  suffix  i  denotes  z  or  θt    or  x˙  or  z˙  or  θ˙t .
The  suffix  j  denotes  θa   or  β  or  η or  θ.  The  first  term  of  Eq.  (2)
evaluates  the  periodicity  of  motion  by  quadratic  form  of  error
between  boundaries.  The  second  term  of  Eq.  (2)  is  mechanical
energy loss of the period. One obtains the most efficient flapping-
of-wing  flight  for  a  mathematical  model  by  minimizing  the  cost
function.  The  obtained  trajectories  are  evaluated  by  comparing
with  experimental  results.  A  gradient  method  finds  the  above-
mentioned learning parameters such that the obtained trajectory
satisfies the definition of the periodic flapping-of-wing flight.
The panel method model can obtain almost periodic trajecto-
ries, though they do not perfectly correspond to the definition of
the  periodic  flight.  The  obtained  periodic  flapping  flight  by  the
panel method model is illustrated in Fig. 10(a).
5.2.  Stability analysis for periodic trajectory
We analyze stability of the periodically flapping flight.
A continuous system of periodically flapping butterfly is con-
sidered as
x˙(t) = f (x(t), t)                                                                   (3)
where state vector is x(t) = [θT (t), θ˙T (t)]T .
Consider  x0(t) is  a  periodic  trajectory  with  period  T   of  the
continuous  system  of  Eq.  (3).  The  state  vector  of  the  continuous
system is obtained every T , i.e. tk   =  kT  (k  =  0, 1, 2, . . .), and the
sampled-data system is made as:
x(tk+1) = f¯(x(tk)).                                                                (4)
The  sampled-data  system  Eq.  (4)  is  expanded  by  the  following
Taylor series about x0.
x(tk+1) = f¯(x0(tk)) +   ∂
f¯
∂xT
(x(tk) − x0(tk)) + · · · .                    (5)
The following perturbation equation of the sampled-data system
is obtained by considering δx(tk)  =  x(tk) −  x0(tk) is very small,
regarding  the  second  and  higher  terms  of  the  Taylor  series  are
negligible, and taking account of x0(tk+1) = f¯(x0(tk)):
δx(tk+1) =   ∂
f¯
∂xT
δx(tk) ,Aδx(tk).                                            (6)
The A is Jacobian matrix of x(tk+1) with respect to x(tk). Using this
sampled-data system, the stability can be analyzed as the evolution
of perturbation.
We have relations
A = 434−1                                                                                                                                             (7)
4 = ξ1  ξ2  · · · ξn                                                                    (8)
3 = diag [λ1  λ2  · · · λn]                                                                              (9)
where λi  and ξi  are an eigenvalue and its normalized eigenvector
of Jacobian matrix A, respectively. Therefore, Eq. (6) is rearranged
as
δχ(tk+1) = 3δχ(tk)                                                             (10)
where
x = 4χ                                                                   (11)
χ = [χ1  χ2   · · ·  χn]T                                                                                                                             (12)
and χ is the modal coordinates vector. The λi  gives the expansion
rate of the perturbation δχi  of the mode i corresponding to the ξi.
Hence, the mode of the i-th eigenvector is stable for |λi|  ≤  1 and
unstable for |λi| > 1. The unstable mode unstabilizes the butterfly
motion in the direction of the corresponding eigenvector.
5.3.  Effects of wakes
To discuss effects of free-vortices in wakes leaving from trailing-
edges,  a  model  is  constructed  where  free-vortices  in  wakes  are
676                                                                                              K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678
(a) Experimental measurement.                                  (b) Numerical simulation.
Fig. 9.   Measured free-flying of flapping butterfly and numerical simulation using measured joint motion.
(a) Model with free-vortices in wakes.                         (b) Model without free-vortices in wakes.
Fig. 10.   Almost periodic flapping-of-wing flight of models.
(a) Slight instability of model with free-vortices in
wakes.
(b) Instability of model without free-vortices in wakes.
Fig. 11.   Instability of periodic flapping-of-wing flight with initial perturbation.
removed  from  the  panel  method  model  and  a  steady  horseshoe
vortex is considered instead. This model is essentially same as the
lumped-vortex method model in the previous section. This model
can obtain almost periodic trajectories, too. The obtained periodic
flapping flight is illustrated in Fig. 10(b).
Because they are not perfectly periodic, the flapping flights in
both Fig. 10(a) and (b) are leaving gradually from the initial flights
and  destabilized.  The  models  with  and  without  free  vortices  go
down  after  ten  or  more  and  a  few  periods  of  flapping  motion,
respectively.
Fig. 11(a) and (b) show the flights started from the initial states
with same small perturbations. Fig. 11(a) and (b), respectively, are
of  the  panel  method  model  and  the  panel  method  model  from
which free-vortices in wakes are removed. Degree of instability of
Fig. 11(a) is smaller than Fig. 11(b). In addition, the sampled-data
systems are derived from the original continuous periodic systems
by observing their states every flapping cycle. The highest unstable
poles of the sampled-data systems of the previous section are 8.6
and 17.0 for the panel method and the panel method without free-
vortices, respectively. This result gives support to the simulations
above.
It is thought that the wake-induced flow of the panel method
provides a type of stabilization effect. This result shows that the
free-vortices  in  the  wakes  are  essential  for  the  stabilization  of
butterfly flights. The details are also reported in [3–6,8].
The butterfly repeats the same joint motion by the controller,
but  the  thorax  motion  and  the  flow  field  do  not  repeat  a  same
periodic  motion.  Therefore,  the  aerodynamic  forces  applied  to
wings   also   vary,   and   this   variation   works   as   disturbance   to
butterfly’s  flight  motion  control.  The  flight  motion  is  the  entire
butterfly  motion  that  is  composed  of  the  thorax  motion  and  the
joint  motion.  It  does  not  have  function  to  suppress  the  error
in   thorax   motion   by   feedback   control,   though   the   controller
suppresses  the  error  in  joint  motion  caused  by  the  disturbance.
According  to  the  above-mentioned  stability  analysis,  the  free-
vortices  in  the  wakes  provide  a  type  of  stabilization  effect.  This
result  shows  that  the  free-vortices  induce  the  interaction  with
the feedback stabilization effect when wings in ‘‘body’’ exchange
aerodynamic   forces   with   ‘‘flow   field’’.   This   is   the   feedback
stabilization  effect  brought  by  this  system  through  the  dynamic
characteristic  of  the  flow  field,  and  it  can  be  considered  as  an
implicit control that is a common principle of mobiligence.
5.4.  Effects of structural flexibility of wings
As  discussed  in  Fig.  5(a),  deformation  of  wings  caused  by
structural  flexibility  leads  to  large  torsion.  Flapping  motion  of
the  model  is  controlled  to  the  desired  trajectory  without  error
in the previous section, whereas that of actual butterflies cannot
be controlled as well because their wings are twisted by various
unexpected  disturbance.  This  passive  torsion  of  wings  has  not
been  considered  in  the  butterfly  model  of  the  above  simulation.
In  this  section,  wing  torsion  caused  by  structural  flexibility  is
introduced  to  the  model  and  its  effect  on  the  flapping-of-wing
flight is examined [7].
To  introduce  the  passive  torsion  to  the  mathematical  model,
the torsional rigidity of wings has been measured by using living
butterflies.  Torsional  moment  loads  are  applied  to  a  wing  of
butterfly with the root of the wing fixed to the horizontal plane.
The torsional rigidity of the wing is obtained by the torsion angles
with  respect  to  the  torsional  moment  loads,  where  the  angles
are captured from camera images. The torsional rigidity of wings
as  an  average  of  some  living  butterflies  is  approximately  8.0  ×
10−4  N m/rad.
K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678                                                                                                      677
(a) Height.
(b) Acceleration of pitching of thorax.
Fig. 12.   Flapping-of-wing flights with/without flexible torsion.
The wing torsion caused by its structural flexibility is modeled
as a single-degree-of-freedom damped oscillator, where a spring
and  a  damper  are  installed  in  the  joint  at  wing  root.  The  model
of  wing  remains  as  a  flat  plate.  The  controller  used  in  the  above
simulation  is  partially  modified  by  using  PD-control  so  as  to
express  the  modeled  passive  torsion.  Because  it  is  difficult  to
measure  damping  of  wings,  the  damping  ratio  is  assumed  to  be
approximately 0.7 and applied to the model.
Numerical simulations analyze how the flexible torsion changes
the  flight  stability.  Fig.  12(a)  and  (b)  show  two  trajectories  of
flapping-of-wing   flights.   By   the   trajectory   searching,   the   two
trajectories have been obtained using the models with and without
flexibly  torsional  wings.  It  is  seen  that  the  oscillation  of  thorax
causes the instability of the flight for the model without flexibly
torsional  wings.  The  flexibly  torsional  wings  extend  the  stable
flight for four more periods. Fig. 12(b) shows that the oscillation
of  θ¨t    is  reduced,  especially  when  the  butterfly  is  going  down.
The wing flexibly damps the pitching oscillation of thorax, where
the  oscillation  may  cause  the  butterfly  falling.  As  the  result,  the
instability of thorax reduced, and the flying period extended.
The same stabilizing effects are demonstrated in three of four
other  simulations  by  the  passive  wing  torsion  in  mathematical
models, where flapping motion is different in each case. Therefore,
the  flexible  torsion  may  introduce  the  stability  effect  on  the
flapping-of-wing flight.
This is the feedback stabilization effect brought by this system
through the dynamic characteristic of the body. It can be consid-
ered as a kind of preflex [14] as well as an implicit control that is a
common principle of mobiligence.
6.  Feedback control of flapping-of-wing flight
As  is  mentioned  above,  the  free-vortices  in  wakes  and  the
flexible  torsion  provide  stabilization  effects.  But,  the  free-flight
realized  by  the  obtained  periodic  joint  motion  is  still  unstable.
Hence,  a  feedback  controller  is  designed  to  stabilize  the  flight.
Dynamics   of   the   periodic   flapping   flight   is   formulated   as   a
sampled-data control system whose sampling time is the flapping
period. The controller design is based on the optimal regulator for
the sampled-data control system.
6.1.  Controller design by optimal regulator
The rigid multi-body model considering free-vortices in wakes
and  its  obtained  periodic  joint  trajectory  in  Section  5.3  are  used
Fig. 13.   Free-flying  motion  of  thorax  with/without  feedback  control  (solid  line:
with control broken line: without control).
to formulate a sampled-data control system whose sampling time
is  the  flapping  period.  The  controller  is  then  designed  by  using
the  sampled-data  control  system,  where  the  state  is  considered
as  δx(tk) for  discrete  time  tk   that  is  the  difference  of  state  x(tk)
from  equilibrium  state  x0(tk).  The  input  δu(tk) is  considered  as
the difference of Fourier parameter vectors u(tk) from the periodic
u0(tk)  that  represent  trajectories  of  θa, β, η,  and  θ  in  interval
[tk, tk+1). The Fourier parameter vector at time tk  is given by δu(tk)
that is computed by the following controller.
u(tk) = u0(tk) + δu(tk).                                                       (13)
A state feedback control is designed by using the optimal regulator
theory as
δu(uk) = −K δx(tk)                                                             (14)
where K  is the obtained feedback gain matrix.
6.2.  Control result
Fig. 13 shows trajectories of flights when the designed sampled-
data  controller  works  and  does  not  work,  where  the  distance  x,
the  height  z,  and  attitude  angle  θt .  In  the  figure,  broken  lines
are  without  the  control  and  solid  lines  are  with  the  control.
The unstable trajectory describes the motion of flapping butterfly
without   the   controller,   where   the   trajectory   is   found   in   the
previous  section.  The  stable  trajectory  describes  the  butterfly
motion with the controller. The designed sampled-data controller
stabilizes  the  flapping-of-wing  flight,  where  the  fully  nonlinear
model  is  controlled  by  the  designed  controller.  More  realistic
control reflecting biological knowledge will be our future subject
because the full state feedback control is supposed.
7.  Concluding remarks
This study has analyzed the mechanism to emerge the flapping
flight  of  butterfly  considering  the  generated  free  vortices  in  the
environment.  First,  flapping  mechanism  of  butterfly  has  been
organized  by  using  anatomical  observation  and  knowledge  of
musculoskeletal  system  to  know  the  available  motion  of  living
butterflies.   The   experimental   system   with   a   low-speed   wind
tunnel  has  been  constructed,  and  the  motion  and  aerodynamic
forces  of  actual  butterflies  have  been  measured  quantitatively.
Then the 3D mathematical model has been constructed. Its validity
678                                                                                              K. Senda et al. / Robotics and Autonomous Systems 60 (2012) 670–678
and accuracy have been examined by comparing with the obtained
experimental  data.  Moreover,  a  periodic  flapping  flight  has  been
realized by using the obtained model. It has clarified that the free-
vortices  in  the  wakes  induced  by  flapping  and  the  wing  torsion
caused  by  structural  flexibility  effect  on  the  stability  of  flapping
flight.  They  have  been  considered  as  the  implicit  controls  that
have been the common principle of mobiligence. But the obtained
trajectory  has  been  still  unstable.  The  feedback  control  as  an
explicit control has been designed and the stable flight has been
realized. For more realistic control reflecting biological knowledge
will be our future subject.
Acknowledgments
The   authors   would   like   to   express   sincere   thanks   to   Dr.
Naomichi  Ogihara  of  Keio  University  for  their  help  in  making
XCT  images  of  a  butterfly,  Prof.  M.  Ishii  of  the  Osaka  Prefecture
Univ.,  and  Ishikawa  Insect  Museum  for  their  help  in  making  use
of butterflies. Part of this work has been financially supported by
a Grant-in-Aid for Scientific Research from Ministry of Education,
Science, Culture, and Sports of Japan.
References
[1]  K.  Senda,  T.  Tanaka,  M.  Sawamoto,  Measurement  and  numerical  simulation
of  a  flapping  butterfly,  in:  Proceedings  of  2nd  International  Symposium  on
Adaptive Motion of Animals and Machines, Kyoto, 2003, pp. 1–7. WeP-II-1.
[2]  K.   Senda,   M.   Sawamoto,   T.   Shibahara,   T.   Tanaka,   Study   on   flapping-of-
wings flight of butterfly with experimental measurement, in: Proceedings of
AIAA Atmospheric Flight Mechanics Conference, AIAA, Reston, Virginia, 2004,
pp. 1–14. AIAA Paper 2004-5368.
[3]  K.  Senda,  M.  Sawamoto,  T.  Tanaka,  T.  Shibahara,  Analysis  on  control  of
flapping-of-wings  flight  of  butterfly,  in:  Proceedings  of  3rd  International
Symposium on Adaptive Motion of Animals and Machines, Ilmenau, Germany,
2005, pp. 1–12.
[4]  K.   Senda,   M.   Sawamoto,   T.   Shibahara,   M.   Kitamura,   T.   Tanaka,   Study
on  flapping-of-wings  flight  of  butterfly  with  numerical  and  experimental
analysis, in: Proceedings of AIAA Atmospheric Flight Mechanics Conference,
AIAA, Reston, Virginia, 2006, pp. 1–16. AIAA Paper 2006-6150.
[5]  K. Senda, M. Sawamoto, M. Kitamura, T. Tanaka, Stabilization of flapping-of-
wing  flight  of  butterfly,  considering  wakes,  in:  N.  Kato,  S.  Kamimura  (Eds.),
Bio-Mechanisms of Swimming and Flying, Springer, Tokyo, 2007, pp. 193–204.
[6]  K. Senda, M. Sawamoto, M. Kitamura, T. Obara, Towards realization of stable
flapping-of-wings  flight  of  butterfly,  in:  Proceedings  of  4th  International
Symposium  on  Adaptive  Motion  of  Animals  and  Machines,  Cleveland,  Ohio,
USA, 2008, pp. 62–63.
[7]  K.  Senda,  M.  Sawamoto,  M.  Kitamura,  T.  Obara,  Effects  of  flexibly  torsional
wings   in  flapping-of-wings  flight  of   butterfly,   in:   Proceedings   of  World
Automation Congress 2008, Waikokoa, Hawaii, USA, 2008, pp. 1–6. ISIAC-338.
[8]  K. Senda, T. Obara, M. Kitamura, T. Nishikata, On flight mechanics of flapping
butterfly, in: Workshop on Future Trends of Mobiligence: in IEEE International
Conference on Robotics and Automation, Kobe, Japan, 2009, pp. 17–22.
[9]  A.K.  Brodsk,  The  Evolution  of  Insect  Flight,  Oxford  University  Press,  Oxford,
1994.
[10]  A. Azuma, The Biokinetics of Flying and Swimming, second ed., AIAA, Reston,
Virginia, 2006.
[11]  J. Katz, A. Plotkin, Low-Speed Aerodynamics, second ed., Cambridge University
Press, Cambridge, 2001.
[12]   T.V.S. of Japan, Handbook of Particle Image Velocimetry, Morikita Publishing
Co., Ltd., Tokyo, 2002.
[13]  S.N.   Fry,   R.   Sayaman,   M.H.   Dickinson,   The   aerodynamics   of   free-flight
maneuvers in drosophila, Science 300 (2003) 495–498.
[14]  I.E.   Brown,   G.E.   Loeb,   A   reductionist   approach   to   creating   and   using
neuromuscular models, in: J.M. Winters, P.E. Crago (Eds.), Biomechanics and
Neural Control of Posture and Movement, Springer, New York, 2000.
Kei   Senda   received   the   M.S.   degrees   in   aeronautical
engineering   in   1988   and   the   Ph.D.   in   engineering   in
1993, both from Osaka Prefecture University. From 1988
to   2008,   he   worked   for   Osaka   Prefecture   University
and  Kanazawa  University.  Since  2008,  he  has  been  a
Professor of Department of Aeronautics and Astronautics,
Graduate  School  of  Engineering,  Kyoto  University.  His
research  activities  have  included  more  than  100  papers
on  the  dynamics  and  control  of  aerospace  systems,  the
intelligence  and  autonomy  for  mechanical  systems,  and
the  motion  intelligence  of  animals.  He  received  the  Best
Presented Paper Award of the AIAA Guidance, Navigation, and Control Conference
in 1992, the Best Paper Award of the Institute of Systems, Control and Information
Engineers in 1994, the Best Paper of the Multi-Conference on Systemics, Cybernetics
and  Informatics  in  2003,  etc.  His  paper  was  one  of  five  finalists  of  the  Best
Conference  Paper  at  the  IEEE  International  Conference  on  Systems,  Man,  and
Cybernetics in 2011.
Takuya   Obara   was   a   master   course   student   of   the
Graduate   School   of   Natural   Science   and   Technology,
Kanazawa   University.   He   received   the   M.S.   degree   in
engineering  in  2010  from  Kanazawa  University.  He  is
now an engineer of Nagoya Aerospace Systems, Mitsubishi
Heavy   Industries,   Ltd.   His   research   interests   include
control of flapping butterflies.
Masahiko  Kitamura  was   a   master   course   student   of
the  Graduate  School  of  Natural  Science  and  Technology,
Kanazawa   University.   He   received   the   M.S.   degree   in
engineering in 2009 from Kanazawa University. He is now
an  engineer  of  Toyota  Motor  Corporation.  His  research
interests include numerical analysis of flapping butterflies.
Tomomi   Nishikata   was   a   master   course   student   of
the  Graduate  School  of  Natural  Science  and  Technology,
Kanazawa  University.  She  received  the  M.S.  degree  in
engineering in 2009 from Kanazawa University. She is now
an  engineer  of  Panasonic  Mobile  Communications  R&D
Lab. Co., Ltd. Her research interests include experimental
analysis of flapping butterflies.
Norio Hirai received the M.Sc. degree in Agricultural Sci-
ence in 1995 and the Ph.D. degree in Environmental Sci-
ences and Technology in 2004, from the Osaka Prefecture
University. From 1995 to 1997, he was a researcher at the
Agricultural Experiment Station of Fukushima Prefecture.
He has been an assistant professor in the Graduate School
of Life and Environmental Sciences, Osaka Prefecture Uni-
versity since 1998. He received the Entomological Society
of Japan Award in 2008. His current research interests in-
clude lifecycle strategy of insects and conservation biology
in  insects  and  aquatic  animals.  He  is  the  author  of  more
than 20 refereed publications in international journals and book chapters.
Makoto  Iima  received   the   M.Sc.   degree   in   1995   and
the   Ph.D.   degree   in   1998   from   Kyoto   University,   all
in   fluid   mechanics.   He   is   an   Associate   Professor   in
Department of Mathematical and Life Sciences, Graduate
School  of  Science,  in  Hiroshima  University.  He  has  been
the  recipient  of  the  Award  for  the  Encouragement  of
Young  Physicists,  the  Physical  Society  of  Japan,  in  2007,
and  also  the  recipient  of  the  Best  Publication  Award,
the Japan Society of Industrial and Applied Mathematics,
in  2009.  His  research  interests  include  fluid  mechanics
and nonlinear physics, particularly in bio-fluid mechanics,
pattern formation, fluid–structure interaction, and mathematical modeling.
Naoto Yokoyama received the M.Sc. degree in 2001 and
the  Ph.D.  degree  in  2004  from  Kyoto  University,  both  in
science.  He  is  an  assistant  professor  in  the  Department
of  Aeronautics  and  Astronautics  in  Kyoto  University.  His
research  interests  include  fluid  physics  and  nonlinear
science,  particularly  in  bio-fluid  mechanics,  turbulence,
pattern formation.
